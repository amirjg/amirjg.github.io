<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Spotify</title>
    
    <!-- 1. STANDARD VIEWPORT -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- 2. THE SPOOFER SCRIPT -->
    <script>
        (function() {
            // Configuration
            const TARGET_WIDTH = 1920;
            const TARGET_HEIGHT = 1080;
            
            // Detect 720p environment
            const isLowRes = window.innerHeight <= 750;
            
            if (isLowRes) {
                console.log(">>> [SPOOFER] 720p Detected. Scaling #root container only.");

                // A. OVERRIDE WINDOW DIMENSIONS (The Lie)
                // We tell the JS engine we are on a 1080p screen
                try {
                    Object.defineProperties(window, {
                        'innerWidth': { get: function() { return TARGET_WIDTH; } },
                        'innerHeight': { get: function() { return TARGET_HEIGHT; } }
                    });
                } catch(e) {}

                // B. SCALE THE ROOT CONTAINER (The Visual Fix)
                const applyScale = () => {
                    const root = document.getElementById('root');
                    if (!root) return;

                    // 1. Calculate Scale based on actual window width
                    // e.g. 1280 / 1920 = 0.6666
                    const realWidth = document.documentElement.clientWidth || window.outerWidth;
                    const scale = realWidth / TARGET_WIDTH;

                    // 2. Force Root to be 1080p
                    root.style.width = TARGET_WIDTH + "px";
                    root.style.height = TARGET_HEIGHT + "px";
                    
                    // 3. Shrink ONLY the root
                    root.style.transform = "scale(" + scale + ")";
                    root.style.transformOrigin = "top left";
                    
                    // 4. Force Absolute positioning so transform works correctly
                    root.style.position = "absolute";
                    root.style.top = "0";
                    root.style.left = "0";
                    
                    // 5. Fix Layout Direction
                    document.body.style.direction = "ltr";
                };

                window.addEventListener('load', applyScale);
                window.addEventListener('resize', applyScale);
                
                // Run periodically to catch if React overwrites styles
                setInterval(applyScale, 2000);
            }
        })();
    </script>

    <link rel="stylesheet" href="https://tv.scdn.co/webos4plus/v2/593b9e7/css/spotifytv.css">

    <style>
        /* BASE RESET */
        body, html { 
            background-color: #000; 
            margin: 0; 
            padding: 0; 
            width: 100%; 
            height: 100%; 
            overflow: hidden; 
        }

        /* SPLASH SCREEN */
        #loadingScreen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #000; opacity: 0; transition: opacity 0.5s;
            pointer-events: none; z-index: 9999;
        }
        body.loading #loadingScreen { opacity: 1; transition: none; }
        
        .spotifyLogo {
            position: absolute; left: 0; right: 0; top: 0; bottom: 0; margin: auto;
            width: 304px; height: 85px; fill: #1ed760;
        }
    </style>

    <!-- CONFIGURATION & MOCK -->
    <script>
        const originalMatchMedia = window.matchMedia;
        window.matchMedia = function(query) {
            if (query.includes('prefers-reduced-motion')) 
                return { matches: false, media: query, onchange: null, addListener:()=>{}, removeListener:()=>{}, addEventListener:()=>{}, removeEventListener:()=>{}, dispatchEvent:()=>false };
            return originalMatchMedia.call(window, query);
        };

        window.__version = '2025.12.17_0-593b9e7';
        window.__revision = '593b9e7';
        window.__basePath = 'https://tv.scdn.co/webos4plus/v2/593b9e7/';
        
        var AUTH_HASH = "M2UyOWNiMThjNGMzNGQ2MDgzN2VjOTRjZjMxZTlmM2U6NDZiYWQwZjE3MDVmNGU5MjllMmViOGU3YTM1YjQ5Mzk=";
        window.location.hash = "auth=" + AUTH_HASH;

        window.PalmSystem = {
            identifier: "com.spotify.client.webos",
            launchParams: JSON.stringify({ "auth": AUTH_HASH, "query": "platform=webos4plus" }),
            country: '{"country":"ITA"}',
            locale: "it-IT",
            modelName: "OLED65C46LA",
            isActivated: true,
            deviceInfo: JSON.stringify({
                modelName: "OLED65C46LA", version: "24.0.0", sdkVersion: "24.0.0", uhd: true, oled: true, 
                ddrSize: "4G", uhd8K: false, hdr10: true, dolbyVision: true, 
                brandName: "LG", manufacturer: "LG Electronics", screenHeight: 2160, screenWidth: 3840
            })
        };
    </script>

    <!-- BRIDGE -->
    <script>
        class PalmServiceBridge {
            constructor() { this.onservicecallback = null; }
            cancel() {}
            call(url, params) {
                let response = { returnValue: true };
                try {
                    if (this.onservicecallback) this.onservicecallback(JSON.stringify(response));
                } catch(e) {}
            }
        }
        window.PalmServiceBridge = PalmServiceBridge;
    </script>

    <!-- ENGINE -->
    <script defer src="https://tv.scdn.co/webos4plus/v2/593b9e7/js/vendors.c2b961bdd56f55fcfed5.js"></script>
    <script defer src="https://tv.scdn.co/webos4plus/v2/593b9e7/js/spotifytv.js"></script>

</body>
</html>
